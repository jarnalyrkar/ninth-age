function w(e){e.querySelector(".tabs-cards__nav-list").addEventListener("click",n=>{if(n.target.classList.contains("tabs-cards__nav-button")&&!n.target.classList.contains("tabs-cards__nav-button--active")){const r=e.querySelector(".tabs-cards__card--active"),c=e.querySelector(".tabs-cards__nav-button--active");r.classList.remove("tabs-cards__card--active"),c.classList.remove("tabs-cards__nav-button--active");const s=n.target.value,a=e.querySelector(`.tabs-cards__card[data-tab="${s}"]`);n.target.classList.add("tabs-cards__nav-button--active"),a.classList.add("tabs-cards__card--active")}})}const L=document.querySelector(".language-selector__dropdown-container"),M=document.querySelector(".language-selector__button");function T(){addEventListener("click",e=>{e.target.classList.contains("language-selector__link")||(e.target===M?L.classList.toggle("language-selector__dropdown-container--open"):b())})}function b(){L.classList.remove("language-selector__dropdown-container--open")}const g=document.querySelector(".site-navigation");function k(){g.classList.remove("site-navigation--open")}function H(){g.classList.contains("site-navigation--open")?g.classList.remove("site-navigation--open"):g.classList.add("site-navigation--open")}function A(e){const t=e.querySelector(".armies-list__armies");e.querySelector(".armies-list__buttons").addEventListener("click",r=>{if(!r.target.classList.contains("army-button--active")&&r.target.classList.contains("army-button")){const c=document.querySelector(".army-button--active");c&&(c.classList.remove("army-button--active"),t.querySelector(".army-featured--show").classList.remove("army-featured--show")),r.target.classList.add("army-button--active");const s=r.target.getAttribute("data-target");t.querySelector(`[id="${s}"]`).classList.add("army-featured--show")}})}const y="https://www.9thbuilder.com";let m=null,f="",q=[],v,_;function D(){_=document.querySelector(".army-list"),document.documentElement.style.setProperty("--army-color","#2F394C"),_.setAttribute("data-theme",E("#2F394C")),C(),x(),j(),P(),I(),B(),R(),F(),X()}async function C(){document.querySelector("#version-select").addEventListener("change",async t=>{try{m=null,m=await W(t.target.value),m=Q(m),$(m)}catch(n){console.error("Error fetching armies:",n)}})}function x(){const e=document.querySelector("#army-select"),t=document.querySelector("#army-sub-version-select");e.addEventListener("change",()=>{_.innerHTML="",document.querySelector(".generator-settings__styles").classList.add("generator-settings__styles--hidden");const r=e.value;let c=m.filter(a=>a.name===r);c.sort((a,i)=>i.released_at-a.released_at);const s=t.querySelector("option[disabled][selected]");t.innerHTML="",s&&(t.appendChild(s),s.selected=!0),c.forEach(a=>{const i=document.createElement("option");i.value=a.id,i.textContent=a.name_with_sub_version,i.setAttribute("data-updated_at",a.updated_at),i.setAttribute("data-released_at",a.released_at),t.appendChild(i)})})}function $(e){const t=document.querySelector("#army-select"),n=t.querySelector("option[disabled][selected]");t.innerHTML="",n&&(t.appendChild(n),n.selected=!0);const r=new Map;e.forEach(c=>{r.has(c.name)||r.set(c.name,c.id)}),r.forEach((c,s)=>{const a=document.createElement("option");a.value=s,a.textContent=s,t.appendChild(a)})}function j(){const e=document.querySelector("#army-sub-version-select");document.addEventListener("change",async t=>{if(t.target==e){const n=document.querySelector(".generator-settings__styles");n.classList.add("generator-settings__styles--hidden"),z(),document.querySelector("#army-list").innerHTML="";const r=e.value;await N(r);let c=await U(r);O(),n.classList.remove("generator-settings__styles--hidden"),G(c)}})}function P(){const e=document.querySelector('input[type="color"]'),t=document.documentElement;e.addEventListener("change",()=>{t.style.setProperty("--army-color",e.value),document.querySelector(".army-list").setAttribute("data-theme",E(e.value))})}function R(){document.querySelector(".global__image-position").addEventListener("change",t=>{const n=document.querySelectorAll(".unit-card");n&&(t.target.id==="global-image-x"&&n.forEach(r=>{r.querySelector(".unit-card__inner").style.backgroundPositionX=t.target.value+"%",r.querySelector(".bg-pos-x").value=t.target.value}),t.target.id==="global-image-y"&&n.forEach(r=>{r.querySelector(".unit-card__inner").style.backgroundPositionY=t.target.value+"%",r.querySelector(".bg-pos-y").value=t.target.value}))})}function B(){const e=document.querySelector("#mix-image-toggle");e.addEventListener("change",()=>{const t=document.querySelectorAll(".unit-card");t&&(e.checked?t.forEach(n=>{n.querySelector(".unit-card__inner").style.backgroundBlendMode="multiply",n.querySelector(".mix-background").checked=!0}):t.forEach(n=>{n.querySelector(".unit-card__inner").style.backgroundBlendMode="unset",n.querySelector(".mix-background").checked=!1}))})}function I(){document.addEventListener("change",e=>{if(e.target.getAttribute("type")==="file"){e.target;const t=e.target.files[0];if(t){new Image;const n=new FileReader;n.onload=r=>{if(e.target.id==="default-image"){const c=document.querySelectorAll(".unit-card");c&&c.forEach(s=>{s.querySelector(".unit-card__inner").style.backgroundImage=`url(${r.target.result})`})}else e.target.closest(".unit-card").querySelector(".unit-card__inner").style.backgroundImage=`url(${r.target.result})`},n.readAsDataURL(t)}}})}function F(){const e=document.querySelector("#global-transparency-toggle");e.addEventListener("change",()=>{e.checked?document.documentElement.style.setProperty("--opacity","50%"):document.documentElement.style.setProperty("--opacity","0%")})}function X(){const e=document.querySelector("#army-list");e.addEventListener("click",t=>{t.target.classList.contains("remove-image-button")&&(t.target.closest(".unit-card").querySelector(".unit-card__inner").removeAttribute("style"),t.target.previousElementSibling.value=null)}),e.addEventListener("change",t=>{const n=t.target.closest(".unit-card__options").previousElementSibling;t.target.classList.contains("bg-pos-x")&&(n.style.backgroundPositionX=t.target.value+"%"),t.target.classList.contains("bg-pos-y")&&(n.style.backgroundPositionY=t.target.value+"%"),t.target.classList.contains("mix-background")&&(t.target.checked?n.style.backgroundBlendMode="multiply":n.style.backgroundBlendMode="unset")})}function z(){document.querySelector(".loader").classList.remove("loader--hidden"),J()}function O(){document.querySelector(".loader").classList.add("loader--hidden"),clearInterval(v)}function G(e){const t=document.querySelector("#army-list");t.innerHTML="";const n=document.querySelector("#unit-card");e.forEach(r=>{let c=n.content.cloneNode(!0);const s=q.find(a=>a.id===r.principal_organisation_id);if(s){let a=s.name;a=="Characters"&&(a="Character"),c.querySelector(".unit-card__category").innerHTML="<p>"+a+"</p>"}c.querySelector(".unit-card__name").innerHTML=r.name,c.querySelector(".unit-card__size").innerHTML=r.carac.height.name,c.querySelector(".unit-card__base").innerHTML=r.carac.base.name+(r.carac.base.name!="See mount"?"mm":""),c.querySelector(".unit-card__charge").innerHTML=o(r.carac.adv)+(o(r.carac.adv)!="mount"?'"':""),c.querySelector(".unit-card__mobility").innerHTML=o(r.carac.mar)+(o(r.carac.mar)!="mount"?'"':""),c.querySelector(".unit-card__courage").innerHTML=o(r.carac.dis),c.querySelector(".unit-card__health-points").innerHTML=o(r.carac.hp),c.querySelector(".unit-card__defense").innerHTML=o(r.carac.def),c.querySelector(".unit-card__resilience").innerHTML=o(r.carac.res),c.querySelector(".unit-card__armour").innerHTML=o(r.carac.arm),r.troops&&r.troops.forEach((a,i)=>{let l=c.querySelector(".unit-card__troop-container");if(i===0)l.querySelector(".unit-card__troop").setAttribute("data-troop-id",a.id),l.querySelector(".unit-card__troop-name").innerHTML=a.name??"/",l.querySelector(".unit-card__troop-attacks").innerHTML=o(a.carac.att)??"/",l.querySelector(".unit-card__troop-offensive-skill").innerHTML=o(a.carac.of)??"/",l.querySelector(".unit-card__troop-strength").innerHTML=o(a.carac.str)??"/",l.querySelector(".unit-card__troop-armour-piercing").innerHTML=o(a.carac.ap)??"/",l.querySelector(".unit-card__troop-agility").innerHTML=o(a.carac.agi)??"/";else{const u=l.querySelector(".unit-card__troop").cloneNode(!0);u.setAttribute("data-troop-id",a.id),u.querySelector(".unit-card__troop-name").innerHTML=a.name??"/",u.querySelector(".unit-card__troop-attacks").innerHTML=o(a.carac.att)??"/",u.querySelector(".unit-card__troop-offensive-skill").innerHTML=o(a.carac.of)??"/",u.querySelector(".unit-card__troop-strength").innerHTML=o(a.carac.str)??"/",u.querySelector(".unit-card__troop-armour-piercing").innerHTML=o(a.carac.ap)??"/",u.querySelector(".unit-card__troop-agility").innerHTML=o(a.carac.agi)??"/",l.appendChild(u)}}),f&&(c.querySelector(".unit-card__icon img").src=y+f),r.model_rule_unit_troops.forEach(a=>{if(a.type_lvl==="Global"&&c.querySelector(".unit-card__global-rules").insertAdjacentHTML("beforeend","<span>"+a.name+"</span>"),a.type_lvl==="Defensive"&&c.querySelector(".unit-card__defensive-rules").insertAdjacentHTML("beforeend","<span>"+a.name+"</span>"),a.type_lvl==="Offensive"){const i=c.querySelector(`.unit-card__troop[data-troop-id="${a.troop_id}"] .unit-card__troop-offensive-rules`);i&&i.insertAdjacentHTML("beforeend","<span>"+a.name+"</span>")}}),t.appendChild(c)})}async function N(e){const t=await fetch(`${y}/en/api/v1/ninth_age/armies/${e}.json`);if(!t.ok)throw new Error("Failed to fetch army data");const n=await t.json(),r=await fetch(`${y}/en/api/v1/ninth_age/army-${e}/organisations/all`);if(!r.ok)throw new Error("Failed to fetch army organization");return q=await r.json(),f=n.medium_logo,n}async function U(e){const t=await fetch(`${y}/en/api/v1/ninth_age/army-${e}/units/full`);if(!t.ok)throw new Error("Failed to fetch army data");return await t.json()}async function W(e){const t=`/en/api/v1/ninth_age/version-${e}/armies/full.json`,n=await fetch(y+t);if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);return n.json()}function Q(e){const t={Official:0,Supplement:1,FanMade:2};return e.sort((n,r)=>(t[n.source]??99)-(t[r.source]??99))}function E(e){const t=V(e);if(t>=128)return"light";if(t<128)return"dark"}function V(e){const t=Y(e);return .299*t[0]+.587*t[1]+.114*t[2]}function Y(e){e=e.substring(1);let t=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4),16);return[t,n,r]}function o(e){if(typeof e=="string")return e.includes("\\ascharacter{}")?e.replace("\\ascharacter{}","C"):e.includes("\\starsymbol{}")?e.replace("\\starsymbol{}","*"):e.includes(",")?" ":e.includes("\\seemount{}")?"mount":e.includes("\\newrule")?e.match(/\\newrule\{([0-9]|10)\}/)[1]:e.includes("\\XDsix")?e.match(/\\XDsix\{([0-9]|10)\}/)[1]+"D6":e.includes("\\XDthree")?e.match(/\\XDthree\{([0-9]|10)\}/)[1]+"D3":e.includes("\\Dsix{}")?"D6":(e.includes("\\frenchsmallcharacs")&&(e=e.replace("\\Dthree{}","D3"),e=e.replace("\\Dsix{}","D6"),e=e.replace("\\frenchsmallcharacs{",""),e=e.substring(0,e.length-1)),e)}function J(){const e=document.querySelector(".loader__statements");if(!e)return;const t=e.querySelector(".active");t&&t.classList.remove("active");const n=Array.from(e.children);let r=p([...n]),c=0;r[0].classList.add("active"),v=setInterval(()=>{const s=e.querySelector(".active");s&&s.classList.remove("active"),r[c].classList.add("active"),c++,c>=r.length&&(r=p([...n]),c=0)},4e3)}function p(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}const h=document.querySelectorAll(".tabs-cards");h&&h.forEach(e=>{w(e)});T();addEventListener("click",e=>{e.target.classList.contains("burger")&&H()});addEventListener("keydown",e=>{e.key==="Escape"&&(b(),k())});const d=document.querySelector("#news-scroll-button");if(d){const e=d.closest(".forum-news").querySelector(".forum-news__list");d.addEventListener("click",()=>{e.scrollLeft<window.innerWidth/2?e.scroll({left:window.innerWidth,behavior:"smooth"}):e.scroll({left:0,behavior:"smooth"})}),e.addEventListener("scroll",()=>{e.scrollLeft<window.innerWidth/2?d.innerHTML!=">"&&(d.innerHTML=">"):d.innerHTML!="<"&&(d.innerHTML="<")})}const S=document.querySelector(".armies-list");S&&A(S);D();
//# sourceMappingURL=site-zjv6r3Vo.js.map
